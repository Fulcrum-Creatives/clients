var $=jQuery.noConflict();!function(){var is_webkit=navigator.userAgent.toLowerCase().indexOf('webkit')>-1,is_opera=navigator.userAgent.toLowerCase().indexOf('opera')>-1,is_ie=navigator.userAgent.toLowerCase().indexOf('msie')>-1;(is_webkit||is_opera||is_ie)&&document.getElementById&&window.addEventListener&&window.addEventListener('hashchange',function(){var element,id=location.hash.substring(1);/^[A-z0-9_-]+$/.test(id)&&(element=document.getElementById(id),element&&(/^(?:a|select|input|button|textarea)$/i.test(element.tagName)||(element.tabIndex=-1),element.focus()))},!1)}(),function($){'use strict';function supportsSVG(){return!!document.createElementNS&&!!document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect}if(document.createElement("picture"),supportsSVG())document.documentElement.className+=' svg';else{document.documentElement.className+=' no-svg';for(var imgs=document.getElementsByTagName('img'),dotSVG=/.*\.svg$/,i=0;i!=imgs.length;++i)imgs[i].src.match(dotSVG)&&(imgs[i].src=imgs[i].src.slice(0,-3)+'png')}$(function(){$('img.svg').each(function(){var $img=$(this),imgID=$img.attr('id'),imgClass=$img.attr('class'),imgURL=$img.attr('src');$.get(imgURL,function(data){var $svg=$(data).find('svg');'undefined'!=typeof imgID&&($svg=$svg.attr('id',imgID)),'undefined'!=typeof imgClass&&($svg=$svg.attr('class',imgClass+' replaced-svg')),$svg=$svg.removeAttr('xmlns:a'),$img.replaceWith($svg)},'xml')})})}(jQuery),function(global,factory){'object'==typeof module&&'object'==typeof module.exports?module.exports=global.document?factory(global,!0):function(window){if(!window.document)throw new Error('Viewer requires a window with a document');return factory(window)}:factory(global)}('undefined'!=typeof window?window:this,function(window,noGlobal){'use strict';function typeOf(obj){return toString.call(obj).slice(8,-1).toLowerCase()}function isString(str){return'string'==typeof str}function isNumber(num){return'number'==typeof num&&!isNaN(num)}function isUndefined(obj){return'undefined'==typeof obj}function isObject(obj){return'object'==typeof obj&&null!==obj}function isPlainObject(obj){var constructor,prototype;if(!isObject(obj))return!1;try{return constructor=obj.constructor,prototype=constructor.prototype,constructor&&prototype&&hasOwnProperty.call(prototype,'isPrototypeOf')}catch(e){return!1}}function isFunction(fn){return'function'===typeOf(fn)}function isArray(arr){return Array.isArray?Array.isArray(arr):'array'===typeOf(arr)}function toArray(obj,offset){return offset=offset>=0?offset:0,Array.from?Array.from(obj).slice(offset):slice.call(obj,offset)}function inArray(value,arr){var index=-1;return arr.indexOf?arr.indexOf(value):(each(arr,function(n,i){return n===value?(index=i,!1):void 0}),index)}function trim(str){return isString(str)&&(str=str.trim?str.trim():str.replace(REGEXP_TRIM,'1')),str}function each(obj,callback){var length,i;if(obj&&isFunction(callback))if(isArray(obj)||isNumber(obj.length))for(i=0,length=obj.length;length>i&&callback.call(obj,obj[i],i,obj)!==!1;i++);else if(isObject(obj))for(i in obj)if(obj.hasOwnProperty(i)&&callback.call(obj,obj[i],i,obj)===!1)break;return obj}function extend(obj){var args;if(arguments.length>1){if(args=toArray(arguments),Object.assign)return Object.assign.apply(Object,args);args.shift(),each(args,function(arg){each(arg,function(prop,i){obj[i]=prop})})}return obj}function proxy(fn,context){var args=toArray(arguments,2);return function(){return fn.apply(context,args.concat(toArray(arguments)))}}function setStyle(element,styles){var style=element.style;each(styles,function(value,property){REGEXP_SUFFIX.test(property)&&isNumber(value)&&(value+='px'),style[property]=value})}function getStyle(element){return window.getComputedStyle?window.getComputedStyle(element,null):element.currentStyle}function hasClass(element,value){return element.classList?element.classList.contains(value):element.className.indexOf(value)>-1}function addClass(element,value){var className;if(value){if(isNumber(element.length))return each(element,function(elem){addClass(elem,value)});if(element.classList)return element.classList.add(value);className=trim(element.className),className?className.indexOf(value)<0&&(element.className=className+' '+value):element.className=value}}function removeClass(element,value){return value?isNumber(element.length)?each(element,function(elem){removeClass(elem,value)}):element.classList?element.classList.remove(value):void(element.className.indexOf(value)>=0&&(element.className=element.className.replace(value,''))):void 0}function toggleClass(element,value,added){return isNumber(element.length)?each(element,function(elem){toggleClass(elem,value,added)}):void(added?addClass(element,value):removeClass(element,value))}function getData(element,name){return isObject(element[name])?element[name]:element.dataset?element.dataset[name]:element.getAttribute('data-'+name)}function setData(element,name,data){isObject(data)&&isUndefined(element[name])?element[name]=data:element.dataset?element.dataset[name]=data:element.setAttribute('data-'+name,data)}function removeData(element,name){isObject(element[name])?delete element[name]:element.dataset?delete element.dataset[name]:element.removeAttribute('data-'+name)}function addListener(element,type,handler,once){var types=trim(type).split(REGEXP_SPACES),originalHandler=handler;return types.length>1?each(types,function(type){addListener(element,type,handler)}):(once&&(handler=function(){return removeListener(element,type,handler),originalHandler.apply(element,arguments)}),void(element.addEventListener?element.addEventListener(type,handler,!1):element.attachEvent&&element.attachEvent('on'+type,handler)))}function removeListener(element,type,handler){var types=trim(type).split(REGEXP_SPACES);return types.length>1?each(types,function(type){removeListener(element,type,handler)}):void(element.removeEventListener?element.removeEventListener(type,handler,!1):element.detachEvent&&element.detachEvent('on'+type,handler))}function dispatchEvent(element,type){var event;return element.dispatchEvent?(isFunction(Event)?event=new Event(type,{bubbles:!0,cancelable:!0}):(event=document.createEvent('Event'),event.initEvent(type,!0,!0)),element.dispatchEvent(event)):element.fireEvent?element.fireEvent('on'+type):void 0}function preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function getEvent(event){var doc,e=event||window.event;return e.target||(e.target=e.srcElement||document),isNumber(e.pageX)||(doc=document.documentElement,e.pageX=e.clientX+(window.scrollX||doc&&doc.scrollLeft||0)-(doc&&doc.clientLeft||0),e.pageY=e.clientY+(window.scrollY||doc&&doc.scrollTop||0)-(doc&&doc.clientTop||0)),e}function getOffset(element){var doc=document.documentElement,box=element.getBoundingClientRect();return{left:box.left+(window.scrollX||doc&&doc.scrollLeft||0)-(doc&&doc.clientLeft||0),top:box.top+(window.scrollY||doc&&doc.scrollTop||0)-(doc&&doc.clientTop||0)}}function getTouchesCenter(touches){var length=touches.length,pageX=0,pageY=0;return length&&(each(touches,function(touch){pageX+=touch.pageX,pageY+=touch.pageY}),pageX/=length,pageY/=length),{pageX:pageX,pageY:pageY}}function getByTag(element,tagName){return element.getElementsByTagName(tagName)}function getByClass(element,className){return element.getElementsByClassName?element.getElementsByClassName(className):element.querySelectorAll('.'+className)}function appendChild(element,elem){return elem.length?each(elem,function(el){appendChild(element,el)}):void element.appendChild(elem)}function removeChild(element){element.parentNode&&element.parentNode.removeChild(element)}function empty(element){for(;element.firstChild;)element.removeChild(element.firstChild)}function setText(element,text){isUndefined(element.textContent)?element.innerText=text:element.textContent=text}function forceReflow(element){return element.offsetWidth}function getImageName(url){return isString(url)?url.replace(/^.*\//,'').replace(/[\?&#].*$/,''):''}function getImageSize(image,callback){var newImage;return image.naturalWidth?callback(image.naturalWidth,image.naturalHeight):(newImage=document.createElement('img'),newImage.onload=function(){callback(this.width,this.height)},void(newImage.src=image.src))}function getTransform(data){var transforms=[],rotate=data.rotate,scaleX=data.scaleX,scaleY=data.scaleY;return isNumber(rotate)&&transforms.push('rotate('+rotate+'deg)'),isNumber(scaleX)&&isNumber(scaleY)&&transforms.push('scale('+scaleX+','+scaleY+')'),transforms.length?transforms.join(' '):'none'}function getResponsiveClass(option){switch(option){case 2:return CLASS_HIDE_XS_DOWN;case 3:return CLASS_HIDE_SM_DOWN;case 4:return CLASS_HIDE_MD_DOWN}}function Viewer(element,options){var _this=this;_this.element=element,_this.options=extend({},Viewer.DEFAULTS,isPlainObject(options)&&options),_this.isImg=!1,_this.isBuilt=!1,_this.isShown=!1,_this.isViewed=!1,_this.isFulled=!1,_this.isPlayed=!1,_this.wheeling=!1,_this.playing=!1,_this.fading=!1,_this.tooltiping=!1,_this.transitioning=!1,_this.action=!1,_this.target=!1,_this.timeout=!1,_this.index=0,_this.length=0,_this.init()}var document=window.document,Event=window.Event,NAMESPACE='viewer',CLASS_FIXED=NAMESPACE+'-fixed',CLASS_OPEN=NAMESPACE+'-open',CLASS_SHOW=NAMESPACE+'-show',CLASS_HIDE=NAMESPACE+'-hide',CLASS_HIDE_XS_DOWN='viewer-hide-xs-down',CLASS_HIDE_SM_DOWN='viewer-hide-sm-down',CLASS_HIDE_MD_DOWN='viewer-hide-md-down',CLASS_FADE=NAMESPACE+'-fade',CLASS_IN=NAMESPACE+'-in',CLASS_MOVE=NAMESPACE+'-move',CLASS_ACTIVE=NAMESPACE+'-active',CLASS_INVISIBLE=NAMESPACE+'-invisible',CLASS_TRANSITION=NAMESPACE+'-transition',CLASS_FULLSCREEN=NAMESPACE+'-fullscreen',CLASS_FULLSCREEN_EXIT=NAMESPACE+'-fullscreen-exit',CLASS_CLOSE=NAMESPACE+'-close',EVENT_MOUSEDOWN='mousedown touchstart pointerdown MSPointerDown',EVENT_MOUSEMOVE='mousemove touchmove pointermove MSPointerMove',EVENT_MOUSEUP='mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel',EVENT_WHEEL='wheel mousewheel DOMMouseScroll',EVENT_TRANSITIONEND='transitionend',EVENT_LOAD='load',EVENT_KEYDOWN='keydown',EVENT_CLICK='click',EVENT_RESIZE='resize',EVENT_BUILD='build',EVENT_BUILT='built',EVENT_SHOW='show',EVENT_SHOWN='shown',EVENT_HIDE='hide',EVENT_HIDDEN='hidden',EVENT_VIEW='view',EVENT_VIEWED='viewed',REGEXP_SUFFIX=/width|height|left|top|marginLeft|marginTop/,REGEXP_TRIM=/^\s+(.*)\s+$/,REGEXP_SPACES=/\s+/,SUPPORT_TRANSITION='undefined'!=typeof document.createElement(NAMESPACE).style.transition,min=Math.min,max=Math.max,abs=Math.abs,sqrt=Math.sqrt,round=Math.round,objectProto=Object.prototype,toString=objectProto.toString,hasOwnProperty=objectProto.hasOwnProperty,slice=Array.prototype.slice;Viewer.prototype={constructor:Viewer,init:function(){var _this=this,options=_this.options,element=_this.element,isImg='img'===element.tagName.toLowerCase(),images=isImg?[element]:getByTag(element,'img'),length=images.length,ready=proxy(_this.ready,_this);getData(element,NAMESPACE)||(setData(element,NAMESPACE,_this),length&&(isFunction(options.build)&&addListener(element,EVENT_BUILD,options.build,!0),dispatchEvent(element,EVENT_BUILD)!==!1&&(SUPPORT_TRANSITION||(options.transition=!1),_this.isImg=isImg,_this.length=length,_this.count=0,_this.images=images,_this.body=document.body,options.inline?(addListener(element,EVENT_BUILT,function(){_this.view()},!0),each(images,function(image){image.complete?ready():addListener(image,EVENT_LOAD,ready,!0)})):addListener(element,EVENT_CLICK,_this._start=proxy(_this.start,_this)))))},ready:function(){var _this=this;_this.count++,_this.count===_this.length&&_this.build()},build:function(){var template,parent,viewer,button,toolbar,navbar,title,rotate,_this=this,options=_this.options,element=_this.element;_this.isBuilt||(template=document.createElement('div'),template.innerHTML=Viewer.TEMPLATE,_this.parent=parent=element.parentNode,_this.viewer=viewer=getByClass(template,'viewer-container')[0],_this.canvas=getByClass(viewer,'viewer-canvas')[0],_this.footer=getByClass(viewer,'viewer-footer')[0],_this.title=title=getByClass(viewer,'viewer-title')[0],_this.toolbar=toolbar=getByClass(viewer,'viewer-toolbar')[0],_this.navbar=navbar=getByClass(viewer,'viewer-navbar')[0],_this.button=button=getByClass(viewer,'viewer-button')[0],_this.tooltipBox=getByClass(viewer,'viewer-tooltip')[0],_this.player=getByClass(viewer,'viewer-player')[0],_this.list=getByClass(viewer,'viewer-list')[0],addClass(title,options.title?getResponsiveClass(options.title):CLASS_HIDE),addClass(toolbar,options.toolbar?getResponsiveClass(options.toolbar):CLASS_HIDE),addClass(navbar,options.navbar?getResponsiveClass(options.navbar):CLASS_HIDE),toggleClass(button,CLASS_HIDE,!options.button),toggleClass(toolbar.querySelectorAll('li[class*=zoom]'),CLASS_INVISIBLE,!options.zoomable),toggleClass(toolbar.querySelectorAll('li[class*=flip]'),CLASS_INVISIBLE,!options.scalable),options.rotatable||(rotate=toolbar.querySelectorAll('li[class*=rotate]'),addClass(rotate,CLASS_INVISIBLE),appendChild(toolbar,rotate)),options.inline?(addClass(button,CLASS_FULLSCREEN),setStyle(viewer,{zIndex:options.zIndexInline}),'static'===getStyle(parent).position&&setStyle(parent,{position:'relative'})):(addClass(button,CLASS_CLOSE),addClass(viewer,CLASS_FIXED),addClass(viewer,CLASS_FADE),addClass(viewer,CLASS_HIDE),setStyle(viewer,{zIndex:options.zIndex})),parent.insertBefore(viewer,element.nextSibling),options.inline&&(_this.render(),_this.bind(),_this.isShown=!0),_this.isBuilt=!0,isFunction(options.built)&&addListener(element,EVENT_BUILT,options.built,!0),dispatchEvent(element,EVENT_BUILT))},unbuild:function(){var _this=this;_this.isBuilt&&(_this.isBuilt=!1,removeChild(_this.viewer))},bind:function(){var _this=this,options=_this.options,element=_this.element,viewer=_this.viewer;isFunction(options.view)&&addListener(element,EVENT_VIEW,options.view),isFunction(options.viewed)&&addListener(element,EVENT_VIEWED,options.viewed),addListener(viewer,EVENT_CLICK,_this._click=proxy(_this.click,_this)),addListener(viewer,EVENT_WHEEL,_this._wheel=proxy(_this.wheel,_this)),addListener(_this.canvas,EVENT_MOUSEDOWN,_this._mousedown=proxy(_this.mousedown,_this)),addListener(document,EVENT_MOUSEMOVE,_this._mousemove=proxy(_this.mousemove,_this)),addListener(document,EVENT_MOUSEUP,_this._mouseup=proxy(_this.mouseup,_this)),addListener(document,EVENT_KEYDOWN,_this._keydown=proxy(_this.keydown,_this)),addListener(window,EVENT_RESIZE,_this._resize=proxy(_this.resize,_this))},unbind:function(){var _this=this,options=_this.options,element=_this.element,viewer=_this.viewer;isFunction(options.view)&&removeListener(element,EVENT_VIEW,options.view),isFunction(options.viewed)&&removeListener(element,EVENT_VIEWED,options.viewed),removeListener(viewer,EVENT_CLICK,_this._click),removeListener(viewer,EVENT_WHEEL,_this._wheel),removeListener(_this.canvas,EVENT_MOUSEDOWN,_this._mousedown),removeListener(document,EVENT_MOUSEMOVE,_this._mousemove),removeListener(document,EVENT_MOUSEUP,_this._mouseup),removeListener(document,EVENT_KEYDOWN,_this._keydown),removeListener(window,EVENT_RESIZE,_this._resize)},render:function(){var _this=this;_this.initContainer(),_this.initViewer(),_this.initList(),_this.renderViewer()},initContainer:function(){var _this=this;_this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var viewerData,_this=this,options=_this.options,parent=_this.parent;options.inline&&(_this.parentData=viewerData={width:max(parent.offsetWidth,options.minWidth),height:max(parent.offsetHeight,options.minHeight)}),(_this.isFulled||!viewerData)&&(viewerData=_this.containerData),_this.viewerData=extend({},viewerData)},renderViewer:function(){var _this=this;_this.options.inline&&!_this.isFulled&&setStyle(_this.viewer,_this.viewerData)},initList:function(){var _this=this,options=_this.options,element=_this.element,list=_this.list,items=[];each(_this.images,function(image,i){var src=image.src,alt=image.alt||getImageName(src),url=options.url;src&&(isString(url)?url=image.getAttribute(url):isFunction(url)&&(url=url.call(element,_this)),items.push("<li><img src=\""+src+"\" data-action=\"view\" data-index=\""+i+"\" data-original-url=\""+(url||src)+"\" alt=\""+alt+"\"></li>"))}),list.innerHTML=items.join(''),each(getByTag(list,'img'),function(image){setData(image,'filled',!0),addListener(image,EVENT_LOAD,proxy(_this.loadImage,_this),!0)}),_this.items=getByTag(list,'li'),options.transition&&addListener(element,EVENT_VIEWED,function(){addClass(list,CLASS_TRANSITION)},!0)},renderList:function(index){var _this=this,i=index||_this.index,width=_this.items[i].offsetWidth||30,outerWidth=width+1;setStyle(_this.list,{width:outerWidth*_this.length,marginLeft:(_this.viewerData.width-width)/2-outerWidth*i})},resetList:function(){var _this=this;empty(_this.list),removeClass(_this.list,CLASS_TRANSITION),setStyle({marginLeft:0})},initImage:function(callback){var _this=this,options=_this.options,image=_this.image,viewerData=_this.viewerData,footerHeight=_this.footer.offsetHeight,viewerWidth=viewerData.width,viewerHeight=max(viewerData.height-footerHeight,footerHeight),oldImageData=_this.imageData||{};getImageSize(image,function(naturalWidth,naturalHeight){var initialImageData,imageData,aspectRatio=naturalWidth/naturalHeight,width=viewerWidth,height=viewerHeight;viewerHeight*aspectRatio>viewerWidth?height=viewerWidth/aspectRatio:width=viewerHeight*aspectRatio,width=min(.9*width,naturalWidth),height=min(.9*height,naturalHeight),imageData={naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:aspectRatio,ratio:width/naturalWidth,width:width,height:height,left:(viewerWidth-width)/2,top:(viewerHeight-height)/2},initialImageData=extend({},imageData),options.rotatable&&(imageData.rotate=oldImageData.rotate||0,initialImageData.rotate=0),options.scalable&&(imageData.scaleX=oldImageData.scaleX||1,imageData.scaleY=oldImageData.scaleY||1,initialImageData.scaleX=1,initialImageData.scaleY=1),_this.imageData=imageData,_this.initialImageData=initialImageData,isFunction(callback)&&callback()})},renderImage:function(callback){var _this=this,image=_this.image,imageData=_this.imageData,transform=getTransform(imageData);setStyle(image,{width:imageData.width,height:imageData.height,marginLeft:imageData.left,marginTop:imageData.top,WebkitTransform:transform,msTransform:transform,transform:transform}),isFunction(callback)&&(_this.transitioning?addListener(image,EVENT_TRANSITIONEND,callback,!0):callback())},resetImage:function(){var _this=this;_this.image&&(removeChild(_this.image),_this.image=null)},start:function(event){var _this=this,e=getEvent(event),target=e.target;'img'===target.tagName.toLowerCase()&&(_this.target=target,_this.show())},click:function(event){var _this=this,e=getEvent(event),target=e.target,action=getData(target,'action'),imageData=_this.imageData;switch(action){case'mix':_this.isPlayed?_this.stop():_this.options.inline?_this.isFulled?_this.exit():_this.full():_this.hide();break;case'view':_this.view(getData(target,'index'));break;case'zoom-in':_this.zoom(.1,!0);break;case'zoom-out':_this.zoom(-.1,!0);break;case'one-to-one':_this.toggle();break;case'reset':_this.reset();break;case'prev':_this.prev();break;case'play':_this.play();break;case'next':_this.next();break;case'rotate-left':_this.rotate(-90);break;case'rotate-right':_this.rotate(90);break;case'flip-horizontal':_this.scaleX(-imageData.scaleX||-1);break;case'flip-vertical':_this.scaleY(-imageData.scaleY||-1);break;default:_this.isPlayed&&_this.stop()}},load:function(){var _this=this,options=_this.options,image=_this.image,viewerData=_this.viewerData;_this.timeout&&(clearTimeout(_this.timeout),_this.timeout=!1),removeClass(image,CLASS_INVISIBLE),image.style.cssText="width:0;height:0;margin-left:"+viewerData.width/2+"px;margin-top:"+viewerData.height/2+"px;max-width:none!important;visibility:visible;",_this.initImage(function(){toggleClass(image,CLASS_TRANSITION,options.transition),toggleClass(image,CLASS_MOVE,options.movable),_this.renderImage(function(){_this.isViewed=!0,dispatchEvent(_this.element,EVENT_VIEWED)})})},loadImage:function(event){var e=getEvent(event),image=e.target,parent=image.parentNode,parentWidth=parent.offsetWidth||30,parentHeight=parent.offsetHeight||50,filled=!!getData(image,'filled');getImageSize(image,function(naturalWidth,naturalHeight){var aspectRatio=naturalWidth/naturalHeight,width=parentWidth,height=parentHeight;parentHeight*aspectRatio>parentWidth?filled?width=parentHeight*aspectRatio:height=parentWidth/aspectRatio:filled?height=parentWidth/aspectRatio:width=parentHeight*aspectRatio,setStyle(image,{width:width,height:height,marginLeft:(parentWidth-width)/2,marginTop:(parentHeight-height)/2})})},resize:function(){var _this=this;_this.initContainer(),_this.initViewer(),_this.renderViewer(),_this.renderList(),_this.isViewed&&_this.initImage(function(){_this.renderImage()}),_this.isPlayed&&each(getByTag(_this.player,'img'),function(image){addListener(image,EVENT_LOAD,proxy(_this.loadImage,_this),!0),dispatchEvent(image,EVENT_LOAD)})},wheel:function(event){var _this=this,e=getEvent(event),ratio=Number(_this.options.zoomRatio)||.1,delta=1;_this.isViewed&&(preventDefault(e),_this.wheeling||(_this.wheeling=!0,setTimeout(function(){_this.wheeling=!1},50),e.deltaY?delta=e.deltaY>0?1:-1:e.wheelDelta?delta=-e.wheelDelta/120:e.detail&&(delta=e.detail>0?1:-1),_this.zoom(-delta*ratio,!0,e)))},keydown:function(event){var _this=this,e=getEvent(event),options=_this.options,key=e.keyCode||e.which||e.charCode;if(_this.isFulled&&options.keyboard)switch(key){case 27:_this.isPlayed?_this.stop():options.inline?_this.isFulled&&_this.exit():_this.hide();break;case 32:_this.isPlayed&&_this.stop();break;case 37:_this.prev();break;case 38:preventDefault(e),_this.zoom(options.zoomRatio,!0);break;case 39:_this.next();break;case 40:preventDefault(e),_this.zoom(-options.zoomRatio,!0);break;case 48:case 49:(e.ctrlKey||e.shiftKey)&&(preventDefault(e),_this.toggle())}},mousedown:function(event){var touchesLength,touch,_this=this,options=_this.options,e=getEvent(event),action=options.movable?'move':!1,touches=e.touches;if(_this.isViewed){if(touches){if(touchesLength=touches.length,touchesLength>1){if(!options.zoomable||2!==touchesLength)return;touch=touches[1],_this.startX2=touch.pageX,_this.startY2=touch.pageY,action='zoom'}else _this.isSwitchable()&&(action='switch');touch=touches[0]}action&&(preventDefault(e),_this.action=action,_this.startX=touch?touch.pageX:e.pageX,_this.startY=touch?touch.pageY:e.pageY)}},mousemove:function(event){var touchesLength,touch,_this=this,options=_this.options,e=getEvent(event),action=_this.action,image=_this.image,touches=e.touches;if(_this.isViewed){if(touches){if(touchesLength=touches.length,touchesLength>1){if(!options.zoomable||2!==touchesLength)return;touch=touches[1],_this.endX2=touch.pageX,_this.endY2=touch.pageY}touch=touches[0]}action&&(preventDefault(e),'move'===action&&options.transition&&hasClass(image,CLASS_TRANSITION)&&removeClass(image,CLASS_TRANSITION),_this.endX=touch?touch.pageX:e.pageX,_this.endY=touch?touch.pageY:e.pageY,_this.change(e))}},mouseup:function(event){var _this=this,e=getEvent(event),action=_this.action;action&&(preventDefault(e),'move'===action&&_this.options.transition&&addClass(_this.image,CLASS_TRANSITION),_this.action=!1)},show:function(){var viewer,_this=this,options=_this.options,element=_this.element;return options.inline||_this.transitioning?_this:(_this.isBuilt||_this.build(),viewer=_this.viewer,isFunction(options.show)&&addListener(element,EVENT_SHOW,options.show,!0),dispatchEvent(element,EVENT_SHOW)===!1?_this:(addClass(_this.body,CLASS_OPEN),removeClass(viewer,CLASS_HIDE),addListener(element,EVENT_SHOWN,function(){_this.view(_this.target?inArray(_this.target,toArray(_this.images)):_this.index),_this.target=!1},!0),options.transition?(_this.transitioning=!0,addClass(viewer,CLASS_TRANSITION),forceReflow(viewer),addListener(viewer,EVENT_TRANSITIONEND,proxy(_this.shown,_this),!0),addClass(viewer,CLASS_IN)):(addClass(viewer,CLASS_IN),_this.shown()),_this))},hide:function(){var _this=this,options=_this.options,element=_this.element,viewer=_this.viewer;return options.inline||_this.transitioning||!_this.isShown?_this:(isFunction(options.hide)&&addListener(element,EVENT_HIDE,options.hide,!0),dispatchEvent(element,EVENT_HIDE)===!1?_this:(_this.isViewed&&options.transition?(_this.transitioning=!0,addListener(_this.image,EVENT_TRANSITIONEND,function(){addListener(viewer,EVENT_TRANSITIONEND,proxy(_this.hidden,_this),!0),removeClass(viewer,CLASS_IN)},!0),_this.zoomTo(0,!1,!1,!0)):(removeClass(viewer,CLASS_IN),_this.hidden()),_this))},view:function(index){var image,item,img,url,alt,_this=this,element=_this.element,title=_this.title,canvas=_this.canvas;return index=Number(index)||0,!_this.isShown||_this.isPlayed||0>index||index>=_this.length||_this.isViewed&&index===_this.index?_this:dispatchEvent(element,EVENT_VIEW)===!1?_this:(item=_this.items[index],img=getByTag(item,'img')[0],url=getData(img,'originalUrl'),alt=img.getAttribute('alt'),image=document.createElement('img'),image.src=url,image.alt=alt,_this.image=image,_this.isViewed&&removeClass(_this.items[_this.index],CLASS_ACTIVE),addClass(item,CLASS_ACTIVE),_this.isViewed=!1,_this.index=index,_this.imageData=null,addClass(canvas,CLASS_INVISIBLE),empty(canvas),appendChild(canvas,image),_this.renderList(),empty(title),addListener(element,EVENT_VIEWED,function(){var imageData=_this.imageData,width=imageData.naturalWidth,height=imageData.naturalHeight;setText(title,alt+' ('+width+' × '+height+')')},!0),image.complete?_this.load():(addListener(image,EVENT_LOAD,proxy(_this.load,_this),!0),_this.timeout&&clearTimeout(_this.timeout),_this.timeout=setTimeout(function(){removeClass(image,CLASS_INVISIBLE),_this.timeout=!1},1e3)),_this)},prev:function(){var _this=this;return _this.view(max(_this.index-1,0)),_this},next:function(){var _this=this;return _this.view(min(_this.index+1,_this.length-1)),_this},move:function(offsetX,offsetY){var _this=this,imageData=_this.imageData;return _this.moveTo(isUndefined(offsetX)?offsetX:imageData.left+Number(offsetX),isUndefined(offsetY)?offsetY:imageData.top+Number(offsetY)),_this},moveTo:function(x,y){var _this=this,imageData=_this.imageData,changed=!1;return isUndefined(y)&&(y=x),x=Number(x),y=Number(y),_this.isViewed&&!_this.isPlayed&&_this.options.movable&&(isNumber(x)&&(imageData.left=x,changed=!0),isNumber(y)&&(imageData.top=y,changed=!0),changed&&_this.renderImage()),_this},zoom:function(ratio,hasTooltip,_originalEvent){var _this=this,imageData=_this.imageData;return ratio=Number(ratio),ratio=0>ratio?1/(1-ratio):1+ratio,_this.zoomTo(imageData.width*ratio/imageData.naturalWidth,hasTooltip,_originalEvent),_this},zoomTo:function(ratio,hasTooltip,_originalEvent,_zoomable){var newWidth,newHeight,offset,center,_this=this,options=_this.options,minZoomRatio=.01,maxZoomRatio=100,imageData=_this.imageData;return ratio=max(0,ratio),isNumber(ratio)&&_this.isViewed&&!_this.isPlayed&&(_zoomable||options.zoomable)&&(_zoomable||(minZoomRatio=max(minZoomRatio,options.minZoomRatio),maxZoomRatio=min(maxZoomRatio,options.maxZoomRatio),ratio=min(max(ratio,minZoomRatio),maxZoomRatio)),ratio>.95&&1.05>ratio&&(ratio=1),newWidth=imageData.naturalWidth*ratio,newHeight=imageData.naturalHeight*ratio,_originalEvent?(offset=getOffset(_this.viewer),center=_originalEvent.touches?getTouchesCenter(_originalEvent.touches):{pageX:_originalEvent.pageX,pageY:_originalEvent.pageY},imageData.left-=(newWidth-imageData.width)*((center.pageX-offset.left-imageData.left)/imageData.width),imageData.top-=(newHeight-imageData.height)*((center.pageY-offset.top-imageData.top)/imageData.height)):(imageData.left-=(newWidth-imageData.width)/2,imageData.top-=(newHeight-imageData.height)/2),imageData.width=newWidth,imageData.height=newHeight,imageData.ratio=ratio,_this.renderImage(),hasTooltip&&_this.tooltip()),_this},rotate:function(degree){var _this=this;return _this.rotateTo((_this.imageData.rotate||0)+Number(degree)),_this},rotateTo:function(degree){var _this=this,imageData=_this.imageData;return degree=Number(degree),isNumber(degree)&&_this.isViewed&&!_this.isPlayed&&_this.options.rotatable&&(imageData.rotate=degree,_this.renderImage()),_this},scale:function(scaleX,scaleY){var _this=this,imageData=_this.imageData,changed=!1;return isUndefined(scaleY)&&(scaleY=scaleX),scaleX=Number(scaleX),scaleY=Number(scaleY),_this.isViewed&&!_this.isPlayed&&_this.options.scalable&&(isNumber(scaleX)&&(imageData.scaleX=scaleX,changed=!0),isNumber(scaleY)&&(imageData.scaleY=scaleY,changed=!0),changed&&_this.renderImage()),_this},scaleX:function(scaleX){var _this=this;return _this.scale(scaleX,_this.imageData.scaleY),_this},scaleY:function(scaleY){var _this=this;return _this.scale(_this.imageData.scaleX,scaleY),_this},play:function(){var playing,_this=this,options=_this.options,player=_this.player,load=proxy(_this.loadImage,_this),list=[],total=0,index=0;return!_this.isShown||_this.isPlayed?_this:(options.fullscreen&&_this.requestFullscreen(),_this.isPlayed=!0,addClass(player,CLASS_SHOW),each(_this.items,function(item,i){var img=getByTag(item,'img')[0],image=document.createElement('img');image.src=getData(img,'originalUrl'),image.alt=img.getAttribute('alt'),total++,addClass(image,CLASS_FADE),toggleClass(image,CLASS_TRANSITION,options.transition),hasClass(item,CLASS_ACTIVE)&&(addClass(image,CLASS_IN),index=i),list.push(image),addListener(image,EVENT_LOAD,load,!0),appendChild(player,image)}),isNumber(options.interval)&&options.interval>0&&(playing=function(){_this.playing=setTimeout(function(){removeClass(list[index],CLASS_IN),index++,index=total>index?index:0,addClass(list[index],CLASS_IN),playing()},options.interval)},total>1&&playing()),_this)},stop:function(){var _this=this,player=_this.player;return _this.isPlayed?(_this.options.fullscreen&&_this.exitFullscreen(),_this.isPlayed=!1,clearTimeout(_this.playing),removeClass(player,CLASS_SHOW),empty(player),_this):_this},full:function(){var _this=this,options=_this.options,viewer=_this.viewer,image=_this.image,list=_this.list;return!_this.isShown||_this.isPlayed||_this.isFulled||!options.inline?_this:(_this.isFulled=!0,addClass(_this.body,CLASS_OPEN),addClass(_this.button,CLASS_FULLSCREEN_EXIT),options.transition&&(removeClass(image,CLASS_TRANSITION),removeClass(list,CLASS_TRANSITION)),addClass(viewer,CLASS_FIXED),viewer.setAttribute('style',''),setStyle(viewer,{zIndex:options.zIndex}),_this.initContainer(),_this.viewerData=extend({},_this.containerData),_this.renderList(),_this.initImage(function(){_this.renderImage(function(){options.transition&&setTimeout(function(){addClass(image,CLASS_TRANSITION),addClass(list,CLASS_TRANSITION)},0)})}),_this)},exit:function(){var _this=this,options=_this.options,viewer=_this.viewer,image=_this.image,list=_this.list;return _this.isFulled?(_this.isFulled=!1,removeClass(_this.body,CLASS_OPEN),removeClass(_this.button,CLASS_FULLSCREEN_EXIT),options.transition&&(removeClass(image,CLASS_TRANSITION),removeClass(list,CLASS_TRANSITION)),removeClass(viewer,CLASS_FIXED),setStyle(viewer,{zIndex:options.zIndexInline}),_this.viewerData=extend({},_this.parentData),_this.renderViewer(),_this.renderList(),_this.initImage(function(){_this.renderImage(function(){options.transition&&setTimeout(function(){addClass(image,CLASS_TRANSITION),addClass(list,CLASS_TRANSITION)},0)})}),_this):_this},tooltip:function(){var _this=this,options=_this.options,tooltipBox=_this.tooltipBox,imageData=_this.imageData;return _this.isViewed&&!_this.isPlayed&&options.tooltip?(setText(tooltipBox,round(100*imageData.ratio)+'%'),_this.tooltiping?clearTimeout(_this.tooltiping):options.transition?(_this.fading&&dispatchEvent(tooltipBox,EVENT_TRANSITIONEND),addClass(tooltipBox,CLASS_SHOW),addClass(tooltipBox,CLASS_FADE),addClass(tooltipBox,CLASS_TRANSITION),forceReflow(tooltipBox),addClass(tooltipBox,CLASS_IN)):addClass(tooltipBox,CLASS_SHOW),_this.tooltiping=setTimeout(function(){
options.transition?(addListener(tooltipBox,EVENT_TRANSITIONEND,function(){removeClass(tooltipBox,CLASS_SHOW),removeClass(tooltipBox,CLASS_FADE),removeClass(tooltipBox,CLASS_TRANSITION),_this.fading=!1},!0),removeClass(tooltipBox,CLASS_IN),_this.fading=!0):removeClass(tooltipBox,CLASS_SHOW),_this.tooltiping=!1},1e3),_this):_this},toggle:function(){var _this=this;return 1===_this.imageData.ratio?_this.zoomTo(_this.initialImageData.ratio,!0):_this.zoomTo(1,!0),_this},reset:function(){var _this=this;return _this.isViewed&&!_this.isPlayed&&(_this.imageData=extend({},_this.initialImageData),_this.renderImage()),_this},update:function(){var index,_this=this,indexes=[];return _this.isImg&&!_this.element.parentNode?_this.destroy():(_this.length=_this.images.length,_this.isBuilt&&(each(_this.items,function(item,i){var img=getByTag(item,'img')[0],image=_this.images[i];image?image.src!==img.src&&indexes.push(i):indexes.push(i)}),setStyle(_this.list,{width:'auto'}),_this.initList(),_this.isShown&&(_this.length?_this.isViewed&&(index=inArray(_this.index,indexes),index>=0?(_this.isViewed=!1,_this.view(max(_this.index-(index+1),0))):addClass(_this.items[_this.index],CLASS_ACTIVE)):(_this.image=null,_this.isViewed=!1,_this.index=0,_this.imageData=null,empty(_this.canvas),empty(_this.title)))),_this)},destroy:function(){var _this=this,element=_this.element;return _this.options.inline?_this.unbind():(_this.isShown&&_this.unbind(),removeListener(element,EVENT_CLICK,_this._start)),_this.unbuild(),removeData(element,NAMESPACE),_this},shown:function(){var _this=this,options=_this.options,element=_this.element;_this.transitioning=!1,_this.isFulled=!0,_this.isShown=!0,_this.isVisible=!0,_this.render(),_this.bind(),isFunction(options.shown)&&addListener(element,EVENT_SHOWN,options.shown,!0),dispatchEvent(element,EVENT_SHOWN)},hidden:function(){var _this=this,options=_this.options,element=_this.element;_this.transitioning=!1,_this.isViewed=!1,_this.isFulled=!1,_this.isShown=!1,_this.isVisible=!1,_this.unbind(),removeClass(_this.body,CLASS_OPEN),addClass(_this.viewer,CLASS_HIDE),_this.resetList(),_this.resetImage(),isFunction(options.hidden)&&addListener(element,EVENT_HIDDEN,options.hidden,!0),dispatchEvent(element,EVENT_HIDDEN)},requestFullscreen:function(){var _this=this,documentElement=document.documentElement;!_this.isFulled||document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||(documentElement.requestFullscreen?documentElement.requestFullscreen():documentElement.msRequestFullscreen?documentElement.msRequestFullscreen():documentElement.mozRequestFullScreen?documentElement.mozRequestFullScreen():documentElement.webkitRequestFullscreen&&documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))},exitFullscreen:function(){var _this=this;_this.isFulled&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())},change:function(originalEvent){var _this=this,offsetX=_this.endX-_this.startX,offsetY=_this.endY-_this.startY;switch(_this.action){case'move':_this.move(offsetX,offsetY);break;case'zoom':_this.zoom(function(x1,y1,x2,y2){var z1=sqrt(x1*x1+y1*y1),z2=sqrt(x2*x2+y2*y2);return(z2-z1)/z1}(abs(_this.startX-_this.startX2),abs(_this.startY-_this.startY2),abs(_this.endX-_this.endX2),abs(_this.endY-_this.endY2)),!1,originalEvent),_this.startX2=_this.endX2,_this.startY2=_this.endY2;break;case'switch':_this.action='switched',abs(offsetX)>abs(offsetY)&&(offsetX>1?_this.prev():-1>offsetX&&_this.next())}_this.startX=_this.endX,_this.startY=_this.endY},isSwitchable:function(){var _this=this,imageData=_this.imageData,viewerData=_this.viewerData;return imageData.left>=0&&imageData.top>=0&&imageData.width<=viewerData.width&&imageData.height<=viewerData.height}},Viewer.DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,keyboard:!0,interval:5e3,minWidth:200,minHeight:100,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:'src',build:null,built:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null},Viewer.TEMPLATE="<div class=\"viewer-container\"><div class=\"viewer-canvas\"></div><div class=\"viewer-footer\"><div class=\"viewer-title\"></div><ul class=\"viewer-toolbar\"><li class=\"viewer-zoom-in\" data-action=\"zoom-in\"></li><li class=\"viewer-zoom-out\" data-action=\"zoom-out\"></li><li class=\"viewer-one-to-one\" data-action=\"one-to-one\"></li><li class=\"viewer-reset\" data-action=\"reset\"></li><li class=\"viewer-prev\" data-action=\"prev\"></li><li class=\"viewer-play\" data-action=\"play\"></li><li class=\"viewer-next\" data-action=\"next\"></li><li class=\"viewer-rotate-left\" data-action=\"rotate-left\"></li><li class=\"viewer-rotate-right\" data-action=\"rotate-right\"></li><li class=\"viewer-flip-horizontal\" data-action=\"flip-horizontal\"></li><li class=\"viewer-flip-vertical\" data-action=\"flip-vertical\"></li></ul><div class=\"viewer-navbar\"><ul class=\"viewer-list\"></ul></div></div><div class=\"viewer-tooltip\"></div><div class=\"viewer-button\" data-action=\"mix\"></div><div class=\"viewer-player\"></div></div>";var _Viewer=window.Viewer;return Viewer.noConflict=function(){return window.Viewer=_Viewer,Viewer},Viewer.setDefaults=function(options){extend(Viewer.DEFAULTS,options)},'function'==typeof define&&define.amd&&define('viewer',[],function(){return Viewer}),noGlobal||(window.Viewer=Viewer),Viewer}),window.onload=function(){'use strict';var viewer,Viewer=window.Viewer,pictures=document.querySelector('.gallery__images'),options={keyboard:!1,transition:!1};viewer=new Viewer(pictures,options)};